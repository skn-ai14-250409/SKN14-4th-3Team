{% extends "layout/base.html" %} 
{% load static %} 
{% block style %}
<link rel="stylesheet" href="{% static 'css/index.css' %}" />
{% endblock style %} 

{% block content %}
<div class="discord-container">
  <!-- 왼쪽 사이드바: 서버/채널 목록 -->
  <div class="discord-sidebar">
    <div class="server-list">
      <div class="server-icon active" title="세탁기/건조기 Q&A">
        <span>🧺</span>
      </div>
    </div>
    
    <div class="channel-list">
      <div class="channel-header">
        <h3>대화 목록</h3>
        <button class="icon-btn" id="newChatBtn" title="새 대화">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
        </button>
      </div>
      
      <div class="channel-category">
        <div class="category-header">
          <span class="category-arrow">▼</span>
          <span>텍스트 채널</span>
        </div>
        <div id="conversationList" class="channels">
          <div class="channel-item active" data-id="1">
            <span class="channel-hash">#</span>
            <span class="channel-name">대화-1</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 메인 채팅 영역 -->
  <div class="discord-main">
    <!-- 상단 헤더 -->
    <div class="discord-header">
      <div class="header-left">
        <span class="channel-hash">#</span>
        <span class="channel-title" id="currentChannelTitle">대화-1</span>
        <span class="channel-topic">세탁기/건조기 매뉴얼 Q&A 챗봇</span>
      </div>
      <div class="header-right">
        <button class="icon-btn" id="searchBtn" title="검색">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
        </button>
        <button class="icon-btn" id="pinBtn" title="고정된 메시지">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z"/>
          </svg>
        </button>
        <button class="icon-btn" id="memberBtn" title="멤버 목록">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- 채팅 메시지 영역 -->
    <div class="discord-content">
      <div class="discord-messages" id="chatMessages">
        <div class="welcome-message">
          <div class="welcome-icon">🧺</div>
          <h2>대화-1에 오신 것을 환영합니다!</h2>
          <p>세탁기/건조기 매뉴얼 Q&A 챗봇이 시작되었습니다.</p>
        </div>
        
        <div class="date-divider">
          <span>오늘</span>
        </div>
      </div>

      <!-- 입력창 영역 -->
      <div class="discord-input-wrapper">
        <!-- 이미지 미리보기 영역 -->
        <div class="image-preview-container" id="imagePreviewContainer" style="display: none;">
          <div class="image-preview-item">
            <img id="imagePreview" src="" alt="미리보기">
            <button class="remove-image" id="removeImage">×</button>
            <div class="image-info">
              <span id="imageName">이미지.jpg</span>
              <span id="imageSize">0 KB</span>
            </div>
          </div>
        </div>
        
        <!-- 입력 폼 -->
        <form id="chatForm" class="discord-input-form">
          <button type="button" class="attach-btn" id="attachBtn" title="파일 첨부">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/>
            </svg>
          </button>
          <input type="file" id="imageInput" accept="image/*" style="display: none;">
          
          <div class="discord-input">
            <input type="text" 
                   id="messageInput" 
                   placeholder="대화-1에 메시지 보내기" 
                   autocomplete="off">
          </div>
          
          <div class="input-actions">
            <button type="button" class="emoji-btn" title="이모티콘">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
              </svg>
            </button>
            <button type="submit" class="send-btn" id="sendBtn" title="전송">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
              </svg>
            </button>
          </div>
        </form>
        
        <!-- 타이핑 표시 -->
        <div class="typing-indicator" id="typingIndicator" style="display: none;">
          <span class="typing-user">Q&A Bot</span>이 입력하고 있어요...
        </div>
      </div>
    </div>
  </div>

  <!-- 오른쪽 사이드바: 정보 패널 -->
  <div class="discord-right-sidebar" id="rightSidebar">
    <div class="info-panel">
      <div class="panel-header">
        <h3>제품 정보</h3>
      </div>
      
      <div class="panel-content">
        <!-- 업로드된 이미지 섹션 -->
        <div class="info-section">
          <h4>업로드된 이미지</h4>
          <div id="imageDisplayArea" class="uploaded-image-area">
            <div class="no-image">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
                <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
              </svg>
              <p>이미지가 없습니다</p>
            </div>
          </div>
        </div>

        <!-- 통계 섹션 -->
        <div class="info-section">
          <h4>통계</h4>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value" id="totalMessages">0</div>
              <div class="stat-label">총 메시지</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="totalConversations">1</div>
              <div class="stat-label">대화 수</div>
            </div>
          </div>
        </div>

        <!-- 도구 섹션 -->
        <div class="info-section">
          <h4>도구</h4>
          <div class="tool-buttons">
            <button class="tool-btn" id="downloadCurrBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
              </svg>
              현재 대화 저장
            </button>
            <button class="tool-btn" id="downloadBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
              </svg>
              전체 대화 저장
            </button>
            <button class="tool-btn danger" id="deleteCurrBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
              </svg>
              현재 대화 삭제
            </button>
            <button class="tool-btn danger" id="clearAllBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
              </svg>
              모든 대화 삭제
            </button>
          </div>
        </div>

        <!-- 정보 섹션 -->
        <div class="info-section">
          <h4>정보</h4>
          <div class="info-box">
            <p>SAMSUNG/LG 세탁기/건조기 매뉴얼을 기반으로 한 Q&A 시스템입니다.</p>
            <p class="info-tech">LangChain + RAG 기술 기반</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %} 

{% block script %}
<script src="{% static 'js/index.js' %}"></script>
{% endblock script %}